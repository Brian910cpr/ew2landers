    - name: Snapshot Enrollware HTML
      run: |
        curl -fSL "https://www.enrollware.com/sitefiles/coastalcprtraining/schedule.html" -o docs/data/enrollware-schedule.html
        wc -c docs/data/enrollware-schedule.html || true

    - name: Set up Python
      uses: actions/setup-python@v5
      with:
        python-version: "3.x"

    - name: Install parser deps
      run: |
        python -m pip install --upgrade pip
        pip install beautifulsoup4 lxml python-dateutil

    - name: Build schedule.json
      run: |
        python scripts/parse_enrollware.py docs/data/enrollware-schedule.html > docs/data/schedule.json
        jq -e . docs/data/schedule.json >/dev/null

    - name: Build status.json
      run: |
        python scripts/build_status_json.py \
          --snapshot docs/data/enrollware-schedule.html \
          --schedule docs/data/schedule.json \
          --out docs/data/status.json

    - name: Commit if changed
      run: |
        if git diff --quiet -- docs/data/schedule.json docs/data/status.json; then
          echo "No changes to commit."
          exit 0
        fi
        git config user.name  "github-actions[bot]"
        git config user.email "41898282+github-actions[bot]@users.noreply.github.com"
        git add docs/data/schedule.json docs/data/status.json
        git commit -m "data: update schedule.json + status.json"
        git push
