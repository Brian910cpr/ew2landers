<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>910CPR – Courses & Schedule</title>

<!-- GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-45PBWBK7KR"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)};gtag('js',new Date());gtag('config','G-45PBWBK7KR');</script>

<!-- GTM -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f)})(window,document,'script','dataLayer','GTM-K58Z4XD');</script>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K58Z4XD" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<style>
:root{
  --ink:#0a1220; --muted:#8fa0bf; --bg:#0e1524;
  --surface:#111a2d; --surface-2:#0f1729; --edge:#1d2a45; --hover:#121f38;
  --accent:#2e7bd9; --accent-2:#4aa3ff;
  --bannerTop:#14213d; --bannerBot:#0f1b33; --bannerText:#e9effa;
  --radius:14px; --radius-sm:10px;
  --shadow:0 8px 24px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.02);
  --shadow-soft:0 4px 14px rgba(0,0,0,.25);
}
*{box-sizing:border-box}
html,body{height:100%}
body{font-family:system-ui, Segoe UI, Roboto, Arial, sans-serif;margin:0;background:linear-gradient(180deg,#0b111e,var(--bg));color:var(--bannerText)}
.wrap{max-width:1100px;margin:auto;padding:22px}
h1{margin:8px 0 16px;font-size:28px;letter-spacing:.2px;color:#f3f7ff}
.muted{opacity:.85;color:var(--muted);font-size:13px}

/* Status bar */
.status{margin:0;padding:10px 16px;font-size:14px;border-bottom:1px solid var(--edge);background:#0a1324;color:#a8b7d4}
.status.ok{background:rgba(60,200,120,.08);color:#bff6d7;border-bottom-color:rgba(60,200,120,.35)}
.status.err{background:rgba(255,180,80,.08);color:#ffdcb0;border-bottom-color:rgba(255,180,80,.35)}

/* Quick-Find styles */
.quick-picks{
  background:#0c1426;border:1px solid var(--edge);border-radius:16px;
  padding:18px;box-shadow:var(--shadow);margin:8px 0 16px;
}
.qp-title{margin:0 0 6px 0;font-size:22px;color:#f3f7ff;text-align:center}
.qp-sub{margin:0 0 12px 0;color:#a8b7d4;font-size:14px;text-align:center}

.qp-grid{display:grid;grid-template-columns:1fr;gap:10px}
@media (min-width:720px){.qp-grid{grid-template-columns:1fr 1fr}}
.qp{
  display:flex;align-items:center;justify-content:center;min-height:50px;
  border-radius:12px;text-decoration:none;font-weight:700;letter-spacing:.2px;
  color:#fff;border:1px solid transparent;box-shadow:var(--shadow-soft)
}
.qp:hover{filter:brightness(1.05)} .qp:active{transform:translateY(1px)}
.pill-blue  {background:linear-gradient(180deg,#2e7bd9,#1a58a3); border-color:#397fd9;}
.pill-red   {background:linear-gradient(180deg,#bf2d3b,#8a1e28); border-color:#c64b56;}
.pill-purple{background:linear-gradient(180deg,#5d59b3,#3f3b8a); border-color:#6965c0;}
.pill-gray  {background:linear-gradient(180deg,#6a7385,#4b5364); border-color:#7c8599;}

/* ===== Top-level TYPE sections ===== */
details.section{
  width:100%;margin:28px 0;border-radius:var(--radius);
  background:var(--surface);border:1px solid var(--edge);overflow:hidden;box-shadow:var(--shadow)
}
details.section:nth-of-type(even){background:var(--surface-2)}
details.section>summary{cursor:pointer;list-style:none;padding:0;outline:none;display:block;width:100%}
.ph-head{
  display:block;width:100%;padding:18px 22px;border-bottom:1px solid var(--edge);
  background:linear-gradient(180deg,var(--bannerTop),var(--bannerBot));color:var(--bannerText)
}
.ph-head .ph-title{font-weight:800;font-size:1.15rem;letter-spacing:.3px}
.ph-head .ph-sub{font-size:12px;opacity:.92;margin-top:6px}
.ph-head a{color:inherit;text-decoration:none;pointer-events:none;cursor:default}
.section-body{padding:18px}

/* Grid of courses UNDER the full-width header */
.courses-grid{display:grid;grid-template-columns:1fr;gap:14px}
@media (min-width:900px){.courses-grid{grid-template-columns:1fr 1fr}}

/* Course cards */
details.course{
  border-radius:var(--radius-sm);border:1px solid var(--edge);
  background:rgba(255,255,255,.02);overflow:hidden;box-shadow:var(--shadow-soft)
}
details.course>summary{
  list-style:none;cursor:pointer;font-weight:700;padding:14px 18px;color:#e5ecfa;
  background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.00));
  border-bottom:1px solid var(--edge);outline:none
}
details.course[open]>summary{background:rgba(46,123,217,.08)}
details.course .body{padding:16px 18px}
.course-title{color:#f1f6ff}
.course-title a{pointer-events:none;text-decoration:none;color:inherit;cursor:default}

/* Sessions list */
.enrclass-list{list-style:none;padding:0;margin:12px 0;display:grid;grid-template-columns:1fr;gap:10px}
@media (min-width:720px){.enrclass-list{grid-template-columns:1fr 1fr}}
.enrclass-list li{margin:0}
.enrclass-list a{
  display:flex;flex-direction:column;gap:4px;border:1px solid rgba(255,255,255,.08);
  border-radius:12px;padding:12px 14px;text-decoration:none;background:linear-gradient(180deg,rgba(255,255,255,.04),rgba(255,255,255,.02));
  color:#f2f6ff;box-shadow:var(--shadow-soft)
}
.enrclass-list a:hover{background:rgba(46,123,217,.12);border-color:rgba(74,163,255,.55)}
.enrclass-list a span{color:#a8b7d4;font-size:12px}

/* Secondary meta */
.meta{font-size:12px;color:#b7c6e3;margin:10px 0 0}
.btn{
  display:inline-flex;align-items:center;gap:8px;margin-top:12px;
  border:1px solid rgba(74,163,255,.4);border-radius:999px;
  padding:10px 14px;text-decoration:none;color:#e9f3ff;background:linear-gradient(180deg,#2e7bd9,#1a58a3);
  box-shadow:0 6px 18px rgba(46,123,217,.35), inset 0 1px 0 rgba(255,255,255,.15);
  font-weight:700;letter-spacing:.2px
}
.btn:hover{background:linear-gradient(180deg,#4aa3ff,#2e7bd9);border-color:#4aa3ff}
.btn:active{transform:translateY(1px)}
</style>
</head>

<body>
<div id="dbg" class="status">Loading…</div>
<div class="wrap">

  <!-- Quick-Find (above the fold) -->
  <section class="quick-picks" aria-label="Popular course shortcuts">
    <h2 class="qp-title">Welcome to 910CPR</h2>
    <p class="qp-sub">Explore our most popular courses below — one click jumps to the live schedule.</p>

    <div class="qp-grid">
      <!-- Each button rewrites itself to the exact #ct… once the snapshot loads -->
      <a class="qp pill-blue"   data-match="BLS Provider - In-person"          href="https://coastalcprtraining.enrollware.com/schedule">BLS In-person</a>
      <a class="qp pill-blue"   data-match="BLS Provider - Online Class"       href="https://coastalcprtraining.enrollware.com/schedule">HeartCode BLS</a>

      <a class="qp pill-red"    data-match="ACLS Provider - In-person Renewal" href="https://coastalcprtraining.enrollware.com/schedule">ACLS In-person Renewal</a>
      <a class="qp pill-red"    data-match="ACLS Provider - Online Class"      href="https://coastalcprtraining.enrollware.com/schedule">HeartCode ACLS</a>

      <a class="qp pill-purple" data-match="PALS Provider - In-person Renewal" href="https://coastalcprtraining.enrollware.com/schedule">PALS In-person Renewal</a>
      <a class="qp pill-purple" data-match="PALS Provider - Online Class"      href="https://coastalcprtraining.enrollware.com/schedule">HeartCode PALS</a>

      <a class="qp pill-gray"   data-match="HSI BLS and Adult First Aid"       href="https://coastalcprtraining.enrollware.com/schedule">HSI First Aid/CPR/AED In-person</a>
      <a class="qp pill-gray"   data-match="Heartsaver Online"                 href="https://coastalcprtraining.enrollware.com/schedule">AHA Heartsaver Online</a>
    </div>
  </section>

  <h1>910CPR Courses & Schedule</h1>
</div>

<script>
const ENR_ORIGIN='https://coastalcprtraining.enrollware.com';
const isCt=id=>typeof id==='string' && /^ct\d{3,}$/i.test(id);
const ctHref=id=>`${ENR_ORIGIN}/schedule#${encodeURIComponent(id)}`;

/* Strip links from headings (placeholders should not be clickable) */
function stripAllAnchors(frag){
  frag.querySelectorAll('a').forEach(a=>{
    const span=document.createElement('span');
    span.innerHTML=a.innerHTML;
    a.replaceWith(span);
  });
  return frag;
}

/* Make relative <img> and <a> absolute to Enrollware origin */
function absolutizeUrls(frag){
  frag.querySelectorAll('img,a').forEach(el=>{
    const attr=el.tagName==='IMG'?'src':'href';
    const v=el.getAttribute(attr); if(!v) return;
    if(/^https?:\/\//i.test(v)) return;
    const abs=v.startsWith('/') ? ENR_ORIGIN+v : ENR_ORIGIN+'/'+v.replace(/^\.?\//,'');
    el.setAttribute(attr,abs);
  });
  return frag;
}

/* Robust CT id finder for a panel */
function getCtId(panel,root){
  let a=panel.querySelector('[id^="ct"],[name^="ct"]');
  if(a){ const id=a.id||a.getAttribute('name')||''; if(isCt(id)) return id; }

  const deepLink=panel.querySelector('a[href*="#ct"]');
  if(deepLink){
    const m=(deepLink.getAttribute('href')||'').match(/#(ct\d{3,})/i);
    if(m && isCt(m[1])) return m[1];
  }

  let prev=panel.previousElementSibling;
  for(let i=0;i<8 && prev;i++){
    if(prev.matches?.('[id^="ct"],[name^="ct"]')){
      const id=prev.id||prev.getAttribute('name')||''; if(isCt(id)) return id;
    }
    const inner=prev.querySelector?.('[id^="ct"],[name^="ct"]');
    if(inner){ const id=inner.id||inner.getAttribute('name')||''; if(isCt(id)) return id; }
    prev=prev.previousElementSibling;
  }

  const walker=document.createTreeWalker(root, NodeFilter.SHOW_ELEMENT, null);
  let last=''; while(walker.nextNode()){
    const el=walker.currentNode;
    if(el===panel) break;
    const id=el.id || el.getAttribute?.('name') || '';
    if(isCt(id)) last=id;
  }
  return last;
}

/* Convert session list to first ~4 weeks (or first N) */
function parseDateFromText(t){
  if(!t) return null;
  const s=String(t).replace(/\u00A0/g,' ').trim();
  const re=/^(?:[A-Za-z]+,\s*)?([A-Za-z]+)\s+(\d{1,2}),\s*(\d{4})\s+at\s+(\d{1,2}):(\d{2})\s*(AM|PM)/i;
  const m=s.match(re); if(!m) return null;
  const months={january:0,february:1,march:2,april:3,may:5-5,june:5, july:6, august:7, september:8, october:9, november:10, december:11}; /* fix below */
}
</script>
<script>
/* (fix months literal separated to avoid copy error) */
const __months = {january:0,february:1,march:2,april:3,may:4,june:5,july:6,august:7,september:8,october:9,november:10,december:11};
function __parseDateFromText(t){
  if(!t) return null;
  const s=String(t).replace(/\u00A0/g,' ').trim();
  const re=/^(?:[A-Za-z]+,\s*)?([A-Za-z]+)\s+(\d{1,2}),\s*(\d{4})\s+at\s+(\d{1,2}):(\d{2})\s*(AM|PM)/i;
  const m=s.match(re); if(!m) return null;
  const mon=__months[m[1].toLowerCase()]; if(mon==null) return null;
  let hr=+m[4],min=+m[5]; const ap=m[6].toUpperCase();
  if(ap==='PM'&&hr<12) hr+=12; if(ap==='AM'&&hr===12) hr=0;
  return new Date(+m[3],mon,+m[2],hr,min);
}
function limitUlToWindow(ul,maxDays=28,maxItems=12){
  if(!ul) return {ul,kept:0,total:0};
  const cutoff=new Date(); cutoff.setDate(cutoff.getDate()+maxDays);
  const lis=[...ul.querySelectorAll(':scope>li')];
  let kept=0,total=0;
  for(const li of lis){
    total++;
    const a=li.querySelector('a');
    const txt=(a?.textContent||li.textContent||'').trim();
    const dt=__parseDateFromText(txt);
    const keep = (!dt) || (dt && dt<=cutoff && kept<maxItems);
    if(keep){ kept++; } else { li.remove(); }
  }
  return {ul,kept,total};
}

/* Helper for the Quick-Find banner — rewrites each button to its actual #ct… link */
function resolveQuickPicks(root){
  const picks = document.querySelectorAll('a.qp[data-match]');
  if(!picks.length) return;

  const panels = [...root.querySelectorAll('.enrpanel')];
  const cache = [];
  function findCtIdByContains(substr){
    const needle = String(substr).toLowerCase();
    const cached = cache.find(x=>x.k===needle);
    if(cached) return cached.v;
    for(const p of panels){
      const h = p.querySelector('.enrpanel-heading,h1,h2,h3,h4');
      if(!h) continue;
      const text = h.textContent.replace(/\s+/g,' ').trim().toLowerCase();
      if(text.includes(needle)){
        const id = getCtId(p, root);
        cache.push({k:needle, v:id});
        return id;
      }
    }
    cache.push({k:needle, v:null});
    return null;
  }

  picks.forEach(a=>{
    const match = a.getAttribute('data-match') || '';
    const ctId = findCtIdByContains(match);
    if(ctId){ a.href = `https://coastalcprtraining.enrollware.com/schedule#${encodeURIComponent(ctId)}`; }
  });
}

/* Snapshot loader */
async function loadSnapshotHTML(){
  const here=location.pathname, base=here.replace(/[^/]+$/,'');
  const tryPaths=[ base+'data/enrollware-schedule.html','/ew2landers/data/enrollware-schedule.html' ];
  for(const url of tryPaths){
    try{ const res=await fetch(url,{cache:'no-cache'}); if(res.ok) return {html:await res.text(),url}; }catch{}
  }
  return {html:null,url:null};
}

/* Curtain behaviors */
function wireCurtains(){
  document.querySelectorAll('details.section').forEach(sec=>{
    sec.addEventListener('toggle',()=>{
      if(sec.open){
        document.querySelectorAll('details.section').forEach(d=>{ if(d!==sec) d.open=false; });
        window.scrollTo({top:sec.getBoundingClientRect().top + window.scrollY - 12, behavior:'smooth'});
      }
    });
  });
  document.querySelectorAll('details.course').forEach(sub=>{
    sub.addEventListener('toggle',()=>{
      if(sub.open){
        window.scrollTo({top:sub.getBoundingClientRect().top + window.scrollY - 12, behavior:'smooth'});
      }
    });
  });
}

/* MAIN */
document.addEventListener('DOMContentLoaded', async()=>{
  const dbg=document.getElementById('dbg');
  const host=document.querySelector('.wrap');

  const load=await loadSnapshotHTML();
  if(!load.html){ dbg.className='status err'; dbg.textContent='Could not load schedule snapshot (docs/data/enrollware-schedule.html)'; return; }

  const root=document.createElement('div'); root.innerHTML=load.html;

  /* Wire Quick-Find buttons now that we have the snapshot */
  resolveQuickPicks(root);

  const panels=[...root.querySelectorAll('.enrpanel')];
  if(!panels.length){ dbg.className='status err'; dbg.textContent='Found snapshot, but no .enrpanel elements.'; return; }

  const sections=[]; let current=null;

  for(const p of panels){
    const headingEl=p.querySelector('.enrpanel-heading,h1,h2,h3,h4'); if(!headingEl) continue;

    // Clean non-link heading (keeps images/icons but removes <a>)
    const headingFrag=headingEl.cloneNode(true);
    absolutizeUrls(headingFrag);
    stripAllAnchors(headingFrag);
    const cleanTitleHTML=`<span class="course-title">${headingFrag.innerHTML.trim()}</span>`;

    // Description without the session list
    const bodyEl=p.querySelector('.enrpanel-body');
    const descClone=bodyEl?bodyEl.cloneNode(true):null;
    if(descClone){ const u=descClone.querySelector('ul.enrclass-list'); if(u) u.remove(); }
    if(descClone) absolutizeUrls(descClone);
    const descHTML=descClone?(descClone.innerHTML||'').trim():'';

    const ul=p.querySelector('ul.enrclass-list');
    const hasDates=!!ul;

    if(!hasDates){
      current={ header:{titleHTML:cleanTitleHTML,descHTML}, courses:[] };
      sections.push(current);
      continue;
    }
    if(!current){
      current={ header:{titleHTML:'<span class="course-title">Courses</span>',descHTML:''}, courses:[] };
      sections.push(current);
    }

    const ulClone=ul.cloneNode(true);
    absolutizeUrls(ulClone);
    const trimmed=limitUlToWindow(ulClone,28,12);
    const ctId=getCtId(p, root);

    current.courses.push({ id:ctId, titleHTML:cleanTitleHTML, descHTML, ul:trimmed.ul, kept:trimmed.kept, total:trimmed.total });
  }

  /* Render sections */
  const anchor = document.querySelector('.wrap h1'); // keep Quick-Find in place
  const container = document.createElement('div');
  anchor.after(container);

  sections.forEach(sec=>{
    const secEl=document.createElement('details'); secEl.className='section';
    secEl.innerHTML=`
      <summary>
        <div class="ph-head">
          <div class="ph-title">${sec.header.titleHTML}</div>
          ${sec.header.descHTML?`<div class="ph-sub">${sec.header.descHTML}</div>`:''}
        </div>
      </summary>
      <div class="section-body">
        <div class="courses-grid"></div>
      </div>`;
    const grid=secEl.querySelector('.courses-grid');

    sec.courses.forEach(c=>{
      const url=isCt(c.id)?ctHref(c.id):`${ENR_ORIGIN}/schedule`;
      const hint=(c.total>c.kept)
        ? `<div class="meta">Showing ${c.kept} of ${c.total} upcoming (~4 weeks). <a class="btn" href="${url}">See all dates</a></div>`
        : `<div class="meta">All upcoming shown. <a class="btn" href="${url}">See all dates</a></div>`;

      const course=document.createElement('details'); course.className='course';
      course.innerHTML=`
        <summary>${c.titleHTML}</summary>
        <div class="body">
          <div class="desc">${c.descHTML}</div>
          <ul class="enrclass-list"></ul>
          ${hint}
        </div>`;
      course.querySelector('.enrclass-list').replaceWith(c.ul);
      grid.appendChild(course);
    });

    container.appendChild(secEl);
  });

  /* Default-open the first TYPE */
  const firstSection=document.querySelector('details.section');
  if(firstSection) firstSection.open=true;

  dbg.className='status ok';
  dbg.textContent=`Loaded ${sections.length} top-level sections from ${load.url||''}`;
  wireCurtains();
});
</script>

<!-- Voice widget -->
<embeddable-voice id="1cf9bf8f-38da-437e-abfb-efa1ce9a02ff"></embeddable-voice>
<script src="https://cdn.247aireceptionist.com/script.js"></script>
</body>
</html>
